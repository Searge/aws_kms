{
	"Version": "2012-10-17",
	"Statement": [
		{
			"Sid": "DenyCreateKeyWithoutRequiredTags",
			"Effect": "Deny",
			"Action": [
				"kms:CreateKey",
				"kms:CreateAlias"
			],
			"Resource": "*",
			"Condition": {
				"Null": {
					"aws:RequestTag/environment": "true"
				}
			}
		},
		{
			"Sid": "DenyInvalidEnvironmentTagValue",
			"Effect": "Deny",
			"Action": [
				"kms:CreateKey",
				"kms:CreateAlias",
				"kms:CreateCustomKeyStore",
				"kms:TagResource"
			],
			"Resource": "*",
			"Condition": {
				"ForAnyValue:StringNotLike": {
					"aws:RequestTag/environment": [
						"dev",
						"prod"
					],
					"aws:ResourceTag/data-classification": [
						"confidential",
						"internal",
						"public"
					]
				}
			}
		},
		{
			"Sid": "DenyRemovalOfRequiredTags",
			"Effect": "Deny",
			"Action": [
				"kms:UntagResource"
			],
			"Resource": "*",
			"Condition": {
				"Null": {
					"aws:RequestTag/environment": "true"
				}
			}
		}
	]
}